<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Barber Pro</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #121212; color: #fff; text-align: center; padding: 20px; margin: 0; }
        h1 { margin: 10px 0; color: #f55036; }
        
        /* ×¢×™×¦×•×‘ ×”×’×œ×¨×™×” */
        .gallery { display: flex; justify-content: center; gap: 10px; margin: 20px 0; min-height: 80px; }
        .gallery img { width: 80px; height: 80px; border-radius: 10px; border: 2px solid #f55036; object-fit: cover; }
        
        /* ×›×¤×ª×•×¨×™× */
        .btn { 
            background: #f55036; color: white; padding: 18px; width: 100%; max-width: 350px; 
            border: none; border-radius: 12px; font-size: 20px; font-weight: bold; margin-top: 15px; 
            cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }
        .btn:disabled { background: #444; color: #888; }
        
        /* ×ª×™×‘×ª ×˜×§×¡×˜ */
        textarea { 
            width: 100%; max-width: 330px; padding: 15px; border-radius: 10px; 
            background: #222; border: 1px solid #444; color: white; font-size: 16px; margin-top: 20px;
        }

        /* ×ª×•×¦××•×ª */
        #results { 
            text-align: right; background: #1e1e1e; padding: 20px; border-radius: 15px; 
            margin-top: 25px; display: none; border: 1px solid #333; line-height: 1.6;
        }
    </style>
</head>
<body>

    <h1>AI Barber ğŸ’ˆ</h1>
    <p style="color:#aaa; font-size:14px;">×”×¢×œ×” 3 ×ª××•× ×•×ª (×¡×œ×¤×™) ×œ× ×™×ª×•×—</p>

    <input type="file" id="cameraInput" accept="image/*" capture="user" style="display:none" onchange="handleFileSelect(event)">
    
    <div class="gallery" id="gallery"></div>

    <button class="btn" onclick="triggerCamera()" id="snapBtn">ğŸ“· ×¦×œ× ×ª××•× ×” (0/3)</button>
    
    <textarea id="notes" rows="3" placeholder="×”×¢×¨×•×ª (×œ××©×œ: ×©×™×¢×¨ ×“×œ×™×œ, ××¤×¨×¦×™×...)"></textarea>
    
    <button class="btn" onclick="analyze()" id="analyzeBtn" disabled>âš¡ × ×ª×— ×•×§×‘×œ ×”××œ×¦×•×ª</button>
    <div id="results">Thinking...</div>

<script>
    // ==========================================
    // ğŸ‘‡ğŸ‘‡ğŸ‘‡ ×ª×“×‘×™×§ ××ª ×”××¤×ª×— ×›××Ÿ ×•×–×”×• ğŸ‘‡ğŸ‘‡ğŸ‘‡
    // ==========================================
    
    const MY_KEY =×´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×´; 

    // ==========================================
    const API_KEY = MY_KEY; 
    let photos = [];

    // ×¤×•× ×§×¦×™×” ×©××¤×¢×™×œ×” ××ª ×”××¦×œ××” ×”×¨×’×™×œ×” ×©×œ ×”××™×™×¤×•×Ÿ
    function triggerCamera() {
        document.getElementById('cameraInput').click();
    }

    // ×¤×•× ×§×¦×™×” ×©××˜×¤×œ×ª ×‘×ª××•× ×” ××—×¨×™ ×©×¦×™×œ××ª
    function handleFileSelect(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            const data = e.target.result;
            photos.push(data);
            
            // ×”×¦×’×ª ×”×ª××•× ×” ×¢×œ ×”××¡×š
            const img = document.createElement('img');
            img.src = data;
            document.getElementById('gallery').appendChild(img);
            
            // ×¢×“×›×•×Ÿ ×›×¤×ª×•×¨
            document.getElementById('snapBtn').innerText = `×¦×œ× ×ª××•× ×” (${photos.length}/3)`;
            
            if (photos.length >= 3) {
                document.getElementById('snapBtn').innerText = "âœ… ×¡×™×™×× ×• ×œ×¦×œ×";
                document.getElementById('snapBtn').disabled = true;
                document.getElementById('analyzeBtn').disabled = false;
            }
        };
        reader.readAsDataURL(file);
    }

    async function analyze() {
        if (!API_KEY.startsWith("gsk_")) { alert("×œ× ×”×“×‘×§×ª ××ª ×”××¤×ª×— ×‘×§×•×“!"); return; }
        
        document.getElementById('analyzeBtn').innerText = "××¢×‘×“ × ×ª×•× ×™×...";
        document.getElementById('analyzeBtn').disabled = true;
        document.getElementById('results').style.display = 'block';
        document.getElementById('results').innerText = "×”-AI ×× ×ª×— ××ª ×”×¤× ×™× ×•×”×©×™×¢×¨ ×©×œ×š... ×× × ×”××ª×Ÿ.";

        const notes = document.getElementById('notes').value;
        const promptText = `User notes: ${notes}. Output HEBREW only. 1. Face shape analysis. 2. 5 hairstyle recommendations explaining why they fit.`;

        const content = [{ type: "text", text: promptText }];
        photos.forEach(p => content.push({ type: "image_url", image_url: { url: p } }));

        try {
            const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                method: "POST",
                headers: { "Content-Type": "application/json", "Authorization": `Bearer ${API_KEY}` },
                body: JSON.stringify({ model: "llama-3.2-11b-vision-preview", messages: [{ role: "user", content: content }], max_tokens: 1000 })
            });
            const data = await res.json();
            if (data.error) throw new Error(data.error.message);
            
            document.getElementById('results').innerHTML = "<h3>ğŸ’ˆ ×ª×•×¦××•×ª:</h3>" + data.choices[0].message.content.replace(/\n/g, '<br>');
        } catch (e) {
            document.getElementById('results').innerText = "×©×’×™××”: " + e.message;
        } finally {
            document.getElementById('analyzeBtn').innerText = "âš¡ × ×ª×— ×©×•×‘";
            document.getElementById('analyzeBtn').disabled = false;
        }
    }
</script>
</body>
</html>
