<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI Barber Final</title>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { 
            background-color: #121212; 
            color: white; 
            font-family: 'Heebo', sans-serif; 
            text-align: center; 
            margin: 0; 
            padding: 20px; 
        }

        /* ×¢×™×¦×•×‘ ×”×›×¤×ª×•×¨ ×”×—×“×© - ×˜×¨×™×§ ×œ××™×™×¤×•×Ÿ */
        .camera-label {
            background: #d4af37; /* ×¦×‘×¢ ×–×”×‘ */
            color: #000;
            font-weight: bold;
            font-size: 20px;
            padding: 20px;
            display: block;
            width: 100%;
            border-radius: 12px;
            margin: 20px 0;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }

        /* ×”×¡×ª×¨×ª ×”××™× ×¤×•×˜ ×”×××™×ª×™ ×‘×¦×•×¨×” ×©×œ× ×©×•×‘×¨×ª ××ª ×”×§×•×“ */
        input[type="file"] {
            display: none;
        }

        .gallery {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .gallery img {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            object-fit: cover;
            border: 2px solid #d4af37;
        }

        textarea {
            width: 100%;
            background: #222;
            color: white;
            border: 1px solid #444;
            padding: 10px;
            font-size: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .analyze-btn {
            background: #444;
            color: #888;
            padding: 15px;
            width: 100%;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: bold;
        }
        
        .analyze-btn.active {
            background: #f55036; /* ×›×ª×•× */
            color: white;
            cursor: pointer;
        }

        #results {
            margin-top: 30px;
            text-align: right;
            background: #1e1e1e;
            padding: 15px;
            border-radius: 10px;
            display: none;
            white-space: pre-wrap; 
        }
    </style>
</head>
<body>

    <h1>ğŸ’ˆ AI Barber</h1>
    <p>×”×¢×œ×” 3 ×ª××•× ×•×ª ×›×“×™ ×œ×§×‘×œ ×”××œ×¦×”</p>

    <div class="gallery" id="gallery"></div>

    <label class="camera-label" id="cameraBtn">
        ğŸ“· ×œ×—×¥ ×›××Ÿ ×œ×¦×™×œ×•×
        <input type="file" accept="image/*" capture="environment" onchange="handleFile(this)">
    </label>

    <textarea id="notes" rows="3" placeholder="×”×¢×¨×•×ª ×œ-AI (×œ××©×œ: ×©×™×¢×¨ ×“×œ×™×œ...)"></textarea>

    <button class="analyze-btn" id="analyzeBtn" onclick="analyze()" disabled>
        ×××ª×™×Ÿ ×œ×ª××•× ×•×ª...
    </button>

    <div id="results"></div>

<script>
    let photos = [];

    function handleFile(input) {
        if (photos.length >= 3) {
            alert("×›×‘×¨ ×™×© 3 ×ª××•× ×•×ª. ×¨×¢× ×Ÿ ×›×“×™ ×œ×”×ª×—×™×œ ××—×“×©.");
            return;
        }

        const file = input.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            photos.push(e.target.result);
            
            // ×”×¦×’×ª ×ª××•× ×”
            const img = document.createElement('img');
            img.src = e.target.result;
            document.getElementById('gallery').appendChild(img);

            // ××™×¤×•×¡ ×”××™× ×¤×•×˜ ×›×“×™ ×©××¤×©×¨ ×™×”×™×” ×œ×¦×œ× ×©×•×‘
            input.value = ""; 

            updateButton();
        }
        reader.readAsDataURL(file);
    }

    function updateButton() {
        const btn = document.getElementById('cameraBtn');
        btn.innerHTML = `ğŸ“· ×¦×œ× ×ª××•× ×” (${photos.length}/3)
        <input type="file" accept="image/*" capture="environment" onchange="handleFile(this)">`;
        
        const analyzeBtn = document.getElementById('analyzeBtn');
        if (photos.length >= 3) {
            analyzeBtn.disabled = false;
            analyzeBtn.classList.add('active');
            analyzeBtn.innerText = "âš¡ × ×ª×— ×©×™×¢×¨ ×¢×›×©×™×•";
            
            // ×”×¡×ª×¨×ª ×›×¤×ª×•×¨ ×”×¦×™×œ×•× ×›×©××¡×™×™××™×
            document.getElementById('cameraBtn').style.display = 'none';
        }
    }

    async function analyze() {
        // ============================================
        // ğŸ‘‡ğŸ‘‡ğŸ‘‡ ×¨×§ ×›××Ÿ ×ª×“×‘×™×§ ××ª ×”××¤×ª×—! ğŸ‘‡ğŸ‘‡ğŸ‘‡
        // ============================================
        
        const API_KEY = "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";
        
        // ğŸ‘†ğŸ‘†ğŸ‘† ××œ ×ª××—×•×§ ××ª ×”×’×¨×©×™×™× "" ğŸ‘†ğŸ‘†ğŸ‘†
        // ============================================

        if (API_KEY.includes("×”×“×‘×§_×›××Ÿ")) {
            alert("×œ× ×”×“×‘×§×ª ××ª ×”××¤×ª×— ×‘×§×•×“!");
            return;
        }

        document.getElementById('analyzeBtn').innerText = "××¢×‘×“...";
        document.getElementById('results').style.display = 'block';
        document.getElementById('results').innerText = "×—×•×©×‘...";

        const notes = document.getElementById('notes').value;
        const prompt = `User notes: ${notes}. Output HEBREW only. 1. Face shape. 2. 5 Haircut recommendations.`;

        const content = [{ type: "text", text: prompt }];
        photos.forEach(p => content.push({ type: "image_url", image_url: { url: p } }));

        try {
            const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                method: "POST",
                headers: { "Content-Type": "application/json", "Authorization": `Bearer ${API_KEY}` },
                body: JSON.stringify({ model: "llama-3.2-11b-vision-preview", messages: [{ role: "user", content: content }] })
            });
            
            const data = await res.json();
            if (data.error) throw new Error(data.error.message);
            document.getElementById('results').innerHTML = data.choices[0].message.content;
            
        } catch (e) {
            alert("×©×’×™××”: " + e.message);
        }
    }
</script>
</body>
</html>
